Quadrocopter wyposa¿ony jest miêdzy innymi w kamerê 3D TOF \href{http://www.pmdtec.com/products_services/reference_design.php}{\textbf{PMD CamBoard nano}}, która zosta³a przedstawiona na rysunku \ref{fig:pmd}. Kamera ta wykorzystuje sensor \emph{PMD PhotonICs 19k-S3}, a jej podstawowe parametry s± nastêpuj±ce:

\begin{description}
\item[rozdzielczo¶æ obrazu] 160x120 pikseli,
\item[czêstotliwo¶æ od¶wie¿ania obrazu] do 90 Hz,
\item[k±ty widzenia] $90^o$ na $68^o$,
\item[wymiary] 37 x 30 x 25 mm,
\item[d³ugo¶æ fali ¶wiat³a] 850nm,
\item[pobór pr±du] oko³o 500mA.
\end{description}


\begin{figure}[ht]
\begin{center}
	\includegraphics[width=0.5\textwidth, angle=0]{grafika/md_camboard.jpg}
	\label{fig:pmd}
	\caption{Wykorzystywana kamera 3D PMD CamBoard nano}
\end{center}
\end{figure}

Przedstawiona kamera wykorzystuje metodê pomiaru okre¶lan± mianem \emph{TOF} (\textit{Time Of Flight}), czyli mierzenia czasu przelotu impulsu. Budowa takiej kamery w postaci blokowej zosta³a przedstawiona na rysunku \ref{fig:zasada_tof}. Odno¶nie zasady dzia³ania, uk³ad nadajnika generuje odpowiednie impulsy ¶wiat³a, które po przej¶ciu przez uk³ad optyczny kierowane s± w stronê przeszkody. Impulsy po odbiciu siê od przeszkody wracaj± do uk³adu odbiorczego, który z u¿yciem specjalizowanego procesora mierzy czas w jakim impuls powróci³. Na tej podstawie, znaj±c prêdko¶æ przelotu, obliczana jest odleg³o¶æ do przeszkody. Uk³ady mierz±ce czas s± zwykle bardzo dok³adne, z tego wzglêdu, ¿e w celu uzyskania rozdzielczo¶ci rzêdu milimetrów pomiar czasu nale¿y wykonywaæ z dok³adno¶ci± do pojedynczych pikosekund. Inn± metod± pomiaru jest metoda po¶rednia polegaj±ca na mierzeniu przesuniêcia fazowego fali odbieranej wzglêdem nadawanej.



\begin{figure}[ht]
\begin{center}
	\includegraphics[width=0.7\textwidth, angle=0]{grafika/md_kamera_tof_dzialanie.png}
	\caption{Budowa i zasada dzia³ania kamery TOF}
	\label{fig:zasada_tof}
\end{center}
\end{figure}

\subsubsection{Portowanie pakietu \emph{pmd\_camboard\_nano}}

 W celu zapewnienia dostêpu do obrazów kamery 3D z poziomu ¶rodowiska \emph{ROS}, które umo¿liwia integracjê tworzonego w ramach projektu oprogramowania zdecydowano siê na przeniesienie pakietu \emph{pmd\_camboard\_nano} obs³uguj±cego kamerê \emph{PMD Camboard nano}, autorstwa Sergey'a Alexandrov'a do nowszej wersji ROS \emph{Hydro} z wersji Fuerte.

Przeniesienie pakietu do ROS'a w wersji Hydro wymaga³o miêdzy innymi zmiany rozwi±zania odno¶nie budowania paczek. W poprzedniej wersji pakietu u¿ywano \emph{rosbuild}, natomiast w nowszej wersji wykorzystano ¶rodowisko \emph{catkin} oparte na wieloplatformowym systemie budowania pakietów \emph{cmake}.

Dodatkowo, zdecydowano siê na usuniêcie z zale¿no¶ci pakietu \emph{dynamic\_reconfigure} odpowiadaj±cego za dynamiczn± zmianê parametrów pakietu, ze wzglêdu na problemy z jego uruchomieniem oraz w celu ujednolicenia sposobu konfiguracji ca³o¶ci oprogramowania, za pomoc± plików \emph{launch}. W obecnej wersji pe³n± konfiguracjê mo¿na przeprowadziæ z u¿yciem odpowiedniego pliku \emph{launch}, w którym opisane zosta³y parametry.

Kolejnym rozwi±zaniem, które uleg³o zmianie jest sposób dostarczania sterowników kamery. W bie¿±cej wersji s± one umieszczane bezpo¶rednio w katalogu \emph{pmd\_driver} pakietu \emph{pmd\_camboard\_nano}. Wykorzystane zosta³y sterowniki w wersji \emph{1.3.2}.\\

\subsubsection{Wybrane topiki publikowane przez pakiet \emph{pmd\_camboard\_nano}}

	\begin{itemize}
	\item obraz w odcieniach szaro¶ci (\textit{/camera/amplitude/image}),
	\item informacje o kamerze i generowanym obrazie (\textit{/camera/amplitude/camera\_info}),
	\item odleg³o¶ci od ¶rodka optycznego sensora(\textit{$\sim$distance/image}),
	\item obraz g³êboko¶ci w mm (\textit{/camera/depth/image}),
	\item informacje o kamerze i mapie g³êboko¶ci (\textit{/camera/depth/camera\_info}),
	\item chmura punktów (\textit{$\sim$points\_unrectified}),
	\end{itemize}

\subsubsection{Uruchomienie pakietu i weryfikacja poprawno¶ci dzia³ania} 
\begin{itemize}
	\item \textsf{source devel/setup.bash} - za³adowanie zmiennych ¶rodowiskowych workspace'a,
	\item \textsf{roslaunch pmd\_camboard\_nano pmd\_camboard\_nano.launch} - uruchomienie pakietu,
	\item \textsf{rosrun image\_view image\_view image:=/camera/depth/image} \\- wy¶wietlenie obrazu g³êbi,
	\item \textsf{rosrun image\_view image\_view image:=/camera/amplitude/image} \\- wy¶wietlenie obrazu w odcieniach szaro¶ci.
\end{itemize}



